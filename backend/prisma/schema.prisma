// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
     engineType = "library" // solution for prisma client error  put engine as library or binary after making changes to this file always run npx prisma generate --no-engine
}
datasource db {
  provider = "postgresql"
  url = env("DATABASE_URL") // user direct db url as (url) first then run migrate command after running migrate cmd make it directUrl() and use connection pool url  as main url
  directUrl = env("DIRECT_URL")

}


model User {
  id String @id  @default(uuid())
  email String @unique
  first_name String? 
  last_name String?
  password String
  image String?        // note Bytes data type is used to store images videos in through prisma which is converted to respective jargon in the rescpective db
  pronoun String?
  domain String?
  about String?
  domain_title String?
  cover_image String?
  like Likes[]
  comment Comments[]
  post Post[]
  notification Notification[]
}

model Post {
  id String @id @default(uuid())
  title String?
  description String?
  user_id String
  created_at DateTime @default(now())
  catagory String
  images Images[] 
  likes Likes[]
  comments Comments[]
  user User @relation(fields: [user_id],references: [id],onDelete: Cascade,onUpdate:Cascade)
}

model Likes{
  id String  @default(uuid())
  user_id String 
  post_id String
  user User @relation(fields: [user_id],references: [id], onDelete: Cascade, onUpdate: Cascade) 
  post Post  @relation(fields: [post_id],references: [id],onDelete: Cascade, onUpdate: Cascade)
  @@id([user_id,post_id]) //composite primary key

}

model Comments {
  id String @default(uuid())
  user_id String
  post_id String
  timestamp DateTime @default(now())
  text String
  user User @relation(fields: [user_id],references: [id],onDelete:Cascade, onUpdate: Cascade)
  post Post @relation(fields:[post_id],references: [id],onDelete: Cascade, onUpdate: Cascade)
  @@id([id,post_id])
}

model Images {
  id String @default(uuid())
  image String?
  post_id String  
  post Post @relation(fields: [post_id],references: [id],onDelete:Cascade, onUpdate: Cascade)
  @@id([id,post_id])
}

model Notification{
  id String @default(uuid())
  user_id String     
  comments Boolean?
  post_uploads  Boolean?
  likes Boolean?
  shares Boolean?
  users User @relation(fields: [user_id],references: [id],onDelete:Cascade,onUpdate:Cascade)
  @@id([id,user_id])
}
